<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>受保护的页面</title>
</head>
<body>
    <h1>恭喜！您已成功访问此页面。</h1>
    <p>您的邮箱是：<span id="user-email"></span></p>
    <button id="logout-btn">退出登录</button>

    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>

    <script>
        // 您的 Firebase 项目配置
        const firebaseConfig = {
            apiKey: "AIzaSyA6MZ_p5lVuy8TMAqiuV6IRx9fggV44lQs",//AIzaSyA6MZ_p5lVuy8TMAqiuV6IRx9fggV44lQs
            authDomain: "outpost-8d74e.firebaseapp.com",
            databaseURL: "https://outpost-8d74e-d45f1.asia-southeast1.firebasedatabase.app/",
            projectId: "outpost-8d74e",
            storageBucket: "outpost-8d74e.firebasestorage.app",
            messagingSenderId: "724993324937",
            appId: "1:724993324937:web:ce6c7e6b06489331c79358",
            measurementId: "G-QPHWRTH6BH"
        };
        
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();

        // 指定允许登录的 Google 账户邮箱清单（与登录页保持一致）
        const allowedUsers = [
            "alexszhang@gmail.com",
            "raytflcmu@gmail.com"
        ];

        // 监听用户的认证状态
        auth.onAuthStateChanged(user => {
            if (user) {
                // 用户已登录
                if (allowedUsers.includes(user.email)) {
                    // 邮箱匹配，显示页面内容
                    document.getElementById('user-email').textContent = user.email;
                } else {
                    // 邮箱不匹配，强制登出并跳转
                    alert('您的账户没有权限访问此页面。');
                    auth.signOut().then(() => {
                        window.location.href = 'outpostLogin.html';
                    });
                }
            } else {
                // 用户未登录，强制跳转到登录页
                alert('请先登录。');
                window.location.href = 'outpostLogin.html';
            }
        });

        // 退出登录按钮
        document.getElementById('logout-btn').addEventListener('click', () => {
            auth.signOut().then(() => {
                alert('您已成功退出登录。');
                window.location.href = 'outpostLogin.html';
            });
        });
    </script>
</body>
</html>