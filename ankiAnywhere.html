<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="UTF-8">
         <meta name="viewport" content="width=device-width, initial-scale=1.0">
         <title>Card Flip Test</title>
         <style>
             body {
                 margin: 0;
                 display: flex;
                 justify-content: center;
                 align-items: center;
                 height: 100vh;
                 background-color: #f0f2f5;
                 -webkit-tap-highlight-color: transparent;
             }

             #flashcardContainer{
                width:95% ;
             }
             .flashcard {
                 width: 100%/*300px*/;
                 height: 200px;
                 perspective: 1000px;
                 cursor: pointer;
                 user-select: none;
             }
             .card-inner {
                 position: relative;
                 width: 100%;
                 height: 100%;
                 transition: transform 0.6s ease;
                 -webkit-transition: -webkit-transform 0.6s ease;
                 transform-style: preserve-3d;
                 -webkit-transform-style: preserve-3d;
                 border-radius: 10px;
                 box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
                 will-change: transform;
                 transform: translate3d(0, 0, 0);
             }
             .flipped .card-inner {
                 transform: rotateY(180deg);
                 -webkit-transform: rotateY(180deg);
                 border: 2px solid red; /* Debug cue */
             }
             .card-front, .card-back {
                 position: absolute;
                 width: 100%;
                 height: 100%;
                 backface-visibility: hidden;
                 -webkit-backface-visibility: hidden;
                 display: flex;
                 align-items: center;
                 justify-content: center;
                 font-size: 1.5em;
                 border-radius: 10px;
                 background-color: white;
                 color: #333;
                 box-sizing: border-box;
                 padding: 10px;
             }
             .card-back {
                 /*transform: rotateY(180deg);
                 -webkit-transform: rotateY(180deg);*/
                 color: black;
                 background-color: #e6f3ff;
             }

             .nav-buttons {
            display: flex;
            justify-content: space-between;
            width: 100%;
            /*max-width: 350px;*/
            margin: 10px 0;
        }
        .nav-buttons button {
            padding: 8px 16px;
            font-size: 1em;
            border: none;
            border-radius: 8px;
            background-color: #007aff;
            color: white;
            -webkit-appearance: none;
        }
        .nav-buttons button:disabled {
            background-color: #cccccc;
        }
        .auth-container {
            text-align: center;
            padding: 15px;
        }
        .auth-container button {
            padding: 8px 16px;
            font-size: 1em;
            border: none;
            border-radius: 8px;
            background-color: #007aff;
            color: white;
            margin: 5px;
        }
        .status {
            font-size: 0.9em;
            margin: 10px 0;
            color: #333;
        }
        /*
        @media (max-width: 600px) {
            .flashcard {
                width: 95%;
                height: 45vh;
            }
            .card-front, .card-back {
                font-size: 1.8em;
            }
        }
        */
         </style>
         <style>
            .noShow{
                display: none;
            }
         </style>
</head>
<body>
    <!-----
    <div class="auth-container" id="authContainer">
        <button id="signInButton">Sign In with Google</button>
        <button id="signOutButton" style="display: none;">Sign Out</button>
        <div class="status" id="authStatus">Please sign in to access flashcards.</div>
    </div>
    -->
    <div class="container" id="flashcardContainer">
        <div class="flashcard" id="flashcard">
            <div class="card-inner">
                <div class="card-front"></div>
                <div class="card-back noShow"></div> 
            </div>
        </div>
        <div class="nav-buttons">
            <button id="prevButton">Previous</button>
            <button id="nextButton">Next</button>
        </div>
    </div>
    <script>
        /*
        // Firebase configuration (Replace with your Firebase project config)
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_AUTH_DOMAIN",
            databaseURL: "YOUR_DATABASE_URL",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_STORAGE_BUCKET",
            messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
            appId: "YOUR_APP_ID"
        };

        // Initialize Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const database = firebase.database();

        // Authentication
        const signInButton = document.getElementById('signInButton');
        const signOutButton = document.getElementById('signOutButton');
        const authStatus = document.getElementById('authStatus');
        const flashcardContainer = document.getElementById('flashcardContainer');

        signInButton.addEventListener('click', () => {
            const provider = new firebase.auth.GoogleAuthProvider();
            auth.signInWithPopup(provider).catch(error => {
                authStatus.textContent = `Error: ${error.message}`;
            });
        });

        signOutButton.addEventListener('click', () => auth.signOut());

        auth.onAuthStateChanged(user => {
            if (user) {
                signInButton.style.display = 'none';
                signOutButton.style.display = 'inline-block';
                authStatus.textContent = `Welcome, ${user.displayName}`;
                flashcardContainer.style.display = 'flex';
                loadFlashcards(user.uid);
            } else {
                signInButton.style.display = 'inline-block';
                signOutButton.style.display = 'none';
                authStatus.textContent = 'Please sign in to access flashcards.';
                flashcardContainer.style.display = 'none';
            }
        });
        */

        // Flashcard logic
        let flashcards = [];
        let currentIndex = 0;
        document.addEventListener("DOMContentLoaded", async (event) => { 
            const flashcard = document.getElementById('flashcard');
            flashcard.addEventListener('click', () => {
                const cardInner = document.querySelector('.card-inner');
                //card-front card-back
                cardInner.querySelector('.card-front').classList.toggle('noShow');
                cardInner.querySelector('.card-back').classList.toggle('noShow');

                //cardInner.classList.toggle('flipped');
                //console.log('Click flip toggled. Is flipped:', cardInner.classList.contains('flipped'));
            });
            flashcard.addEventListener('touchstart', (e) => {
                e.preventDefault();
                const cardInner = document.querySelector('.card-inner');
                cardInner.querySelector('.card-front').classList.toggle('noShow');
                cardInner.querySelector('.card-back').classList.toggle('noShow');
                //cardInner.classList.toggle('flipped');
                //console.log('Touch flip toggled. Is flipped:', cardInner.classList.contains('flipped'));
            });

            await loadFlashcards() ;

        }) ;


        /*
        function loadFlashcards(userId) {
            const dbRef = database.ref(`users/${userId}/flashcards`);
            dbRef.once('value', snapshot => {
                const data = snapshot.val();
                if (data) {
                    flashcards = Object.values(data);
                } else {
                    const defaultData = `
                        เป็น - is
                        ไป - go
                        มา - come
                        ทำ - do, make
                        ว่า - say
                        ซื้อ - buy
                        ขาย - sell
                        กิน - eat
                    `;
                    flashcards = parseThaiEnglish(defaultData);
                    dbRef.set(flashcards);
                }
                displayFlashcard();
            });
        }
        */
        async function loadFlashcards(userId) {
            
            let urlWordSet = `https://outpost-8d74e-14018.firebaseio.com/wordSets/100CommonNouns.json` ;
            let response = await fetch(urlWordSet) ;
            flashcards = await response.json() ;
            console.log(flashcards) ;
            //flashcards
            displayFlashcard();

        }

        function displayFlashcard() {
            if (!flashcards.length) return;
            document.querySelector('.card-front').textContent = flashcards[currentIndex].Word;
            document.querySelector('.card-back').textContent = flashcards[currentIndex].English;
            //document.querySelector('.card-inner').classList.remove('flipped');
            updateButtons();
        }

        function updateButtons() {
            document.getElementById('prevButton').disabled = currentIndex === 0;
            document.getElementById('nextButton').disabled = currentIndex === flashcards.length - 1;
        }

        /*
        document.getElementById('flashcard').addEventListener('click', () => {
            document.querySelector('.card-inner').classList.toggle('flipped');
        });
        */

        document.getElementById('prevButton').addEventListener('click', () => {
            if (currentIndex > 0) {
                currentIndex--;
                displayFlashcard();
            }
        });

        document.getElementById('nextButton').addEventListener('click', () => {
            if (currentIndex < flashcards.length - 1) {
                currentIndex++;
                displayFlashcard();
            }
        });

        // Prevent pinch-to-zoom on iOS
        document.addEventListener('gesturestart', e => e.preventDefault());
        document.addEventListener('gesturechange', e => e.preventDefault());
        document.addEventListener('gestureend', e => e.preventDefault());
    </script>
</body>
</html>